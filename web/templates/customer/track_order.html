{% extends "base.html" %}

{% block title %}Track Order{% endblock %}

{% block sidebar %}
<h5 class="text-light px-3 mb-3">Customer Menu</h5>
<a href="{{ url_for('customer_dashboard') }}">
    <i class="fas fa-chart-line me-2"></i>Dashboard
</a>
<a href="{{ url_for('customer_orders') }}" class="active">
    <i class="fas fa-shopping-cart me-2"></i>My Orders
</a>
<a href="{{ url_for('place_order') }}">
    <i class="fas fa-plus-circle me-2"></i>Place Order
</a>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col">
            <h2>Track Order #{{ order_id }}</h2>
            <p class="text-muted">Real-time tracking and status updates</p>
        </div>
        <div class="col-auto">
            <a href="{{ url_for('customer_orders') }}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left me-2"></i>Back to Orders
            </a>
        </div>
    </div>

    <div class="row">
        <!-- Order Status Timeline -->
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Order Status</h5>
                    <div class="timeline mt-4">
                        <div class="timeline-item completed">
                            <div class="timeline-marker">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="timeline-content">
                                <h6>Order Placed</h6>
                                <p class="text-muted mb-0">Jan 15, 2024 10:30 AM</p>
                                <small>Order confirmed and payment processed</small>
                            </div>
                        </div>
                        <div class="timeline-item completed">
                            <div class="timeline-marker">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="timeline-content">
                                <h6>Processing</h6>
                                <p class="text-muted mb-0">Jan 15, 2024 11:45 AM</p>
                                <small>Order is being prepared for shipment</small>
                            </div>
                        </div>
                        <div class="timeline-item active">
                            <div class="timeline-marker">
                                <i class="fas fa-truck"></i>
                            </div>
                            <div class="timeline-content">
                                <h6>In Transit</h6>
                                <p class="text-muted mb-0">Jan 15, 2024 2:15 PM</p>
                                <small>Order is on its way to delivery</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="timeline-content">
                                <h6>Out for Delivery</h6>
                                <p class="text-muted mb-0">Pending</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker">
                                <i class="fas fa-flag-checkered"></i>
                            </div>
                            <div class="timeline-content">
                                <h6>Delivered</h6>
                                <p class="text-muted mb-0">Expected: Jan 16, 2024</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Order Details -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Order Details</h5>
                    <div class="mb-3">
                        <h6>Delivery Address</h6>
                        <p class="mb-0">123 Customer Street</p>
                        <p class="mb-0">Apt 4B</p>
                        <p class="mb-0">City, State 12345</p>
                    </div>
                    <div class="mb-3">
                        <h6>Items</h6>
                        <ul class="list-unstyled">
                            <li>Apples - 50kg</li>
                            <li>Oranges - 30kg</li>
                        </ul>
                    </div>
                    <div>
                        <h6>Additional Notes</h6>
                        <p class="mb-0">Please deliver during business hours</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map and Real-time Tracking -->
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Live Tracking</h5>
                    <div id="tracking-map" style="height: 400px; background-color: #eee;">
                        <!-- Map will be initialized here -->
                        <div class="text-center py-5">
                            <i class="fas fa-map-marked-alt fa-3x text-muted"></i>
                            <p class="mt-3 text-muted">Loading tracking map...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Shipment Conditions -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Shipment Conditions</h5>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Temperature</h6>
                                    <div class="display-6 mb-2">4Â°C</div>
                                    <span class="badge bg-success">Optimal</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Humidity</h6>
                                    <div class="display-6 mb-2">65%</div>
                                    <span class="badge bg-success">Optimal</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Freshness</h6>
                                    <div class="display-6 mb-2">95%</div>
                                    <span class="badge bg-success">Excellent</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.timeline {
    position: relative;
    padding-left: 30px;
}

.timeline-item {
    position: relative;
    padding-bottom: 30px;
}

.timeline-item:last-child {
    padding-bottom: 0;
}

.timeline-marker {
    position: absolute;
    left: -30px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
}

.timeline-item::before {
    content: '';
    position: absolute;
    left: -21px;
    top: 20px;
    height: 100%;
    width: 2px;
    background: #e9ecef;
}

.timeline-item:last-child::before {
    display: none;
}

.timeline-item.completed .timeline-marker {
    background: #28a745;
    color: white;
}

.timeline-item.active .timeline-marker {
    background: #007bff;
    color: white;
}

.timeline-content {
    padding-left: 15px;
}
</style>

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize map and real-time tracking here
    // This is a placeholder for actual map implementation
});

// Function to update shipment conditions
function updateShipmentConditions() {
    // This would be replaced with real-time data from the sensors
}

// Update conditions every minute
setInterval(updateShipmentConditions, 60000);
</script>
{% endblock %}
{% endblock %}
